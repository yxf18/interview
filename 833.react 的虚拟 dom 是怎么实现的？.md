# Problem: react 的虚拟 dom 是怎么实现的？

*[interview]: start
React 的虚拟 DOM（Virtual DOM）是一种在内存中以 JavaScript 对象的形式表示的 DOM 树结构。它是 React 用来管理页面渲染和更新的核心机制之一。

虚拟 DOM 的实现原理如下：

1. **创建虚拟 DOM 树：** 当 React 组件被渲染时，会生成一个虚拟 DOM 树，该树结构以 JavaScript 对象的形式表示整个页面的结构，包括元素、属性和文本内容等信息。

2. **渲染虚拟 DOM 到真实 DOM：** 将虚拟 DOM 树转换为真实的 DOM 元素，并插入到页面中。React 使用渲染引擎将虚拟 DOM 转换为真实 DOM，并将其添加到页面中。

3. **更新虚拟 DOM：** 当组件的状态发生变化时，React 不会直接操作真实的 DOM，而是生成一个新的虚拟 DOM 树。然后，React 会将新的虚拟 DOM 树与旧的虚拟 DOM 树进行比较，找出两者之间的差异，这个过程称为“协调（Reconciliation）”。

4. **批量更新差异：** React 会将所有需要更新的差异记录下来，并批量更新到真实的 DOM 中。这样可以减少对真实 DOM 的操作次数，提高页面渲染的性能。

5. **重用组件：** 在协调过程中，React 会尽可能地重用已有的组件实例，避免不必要的销毁和创建，从而减少了页面重新渲染的成本。

通过使用虚拟 DOM，React 实现了高效的页面渲染和更新机制。它通过比较虚拟 DOM 树之间的差异，只更新需要改变的部分，从而减少了对真实 DOM 的操作次数，提高了页面渲染的性能和效率。

## 关键词: React, 虚拟 DOM, 渲染, 更新, 协调, 批量更新, 组件重用, diff 算法
*[interview]: end
