# Problem: 说一下 React diff 算法。

*[interview]: start
React 的 Virtual DOM 及其 diff 算法是其高效渲染的核心。Diff 算法是指在进行 Virtual DOM 对比时，React 会找出变化的部分，并更新实际 DOM 中相应的部分，而不是对整个 DOM 树进行重新渲染。

以下是 React 的 diff 算法的基本原理：
1. **树的比较：** React 会比较两棵树的结构，即前后两次渲染的 Virtual DOM 树。React 使用**深度优先搜索算法（DFS）**来遍历两棵树的所有节点，对比节点的类型及属性，找出差异。
2. **同层比较：** React 会尽量在相**同层级**的节点之间进行比较，而不是跨层级比较。这样可以减少比较的时间复杂度，提高 diff 的效率。
3. **Keys 的作用：** 在进行同层比较时，React 会使用节点的 Key 属性来识别节点。Key 属性是一个唯一标识符，可以帮助 React 更精确地定位到每个节点的变化，避免不必要的更新和重渲染。

4. **更新策略：** 根据对比的结果，React 会生成一系列更新操作，包括插入、更新和删除等操作。React 尽量将这些更新操作合并成一个批处理，然后一次性更新到实际的 DOM 上，以减少浏览器**重绘和重排**的次数，提高性能。

5. **优化策略：** React 会尽量复用相同类型的组件，避免不必要的销毁和重新创建。只有在组件类型不同或者 Key 不同的情况下，才会进行销毁和重新创建操作。

总体来说，React 的 diff 算法通过智能地对比 Virtual DOM 树，找出变化的部分，并尽可能地减少 DOM 操作，从而提高了渲染性能和用户体验。Diff 算法的优化是 React 能够在大规模数据更新时仍然保持良好性能的关键之一。

## 关键词: React, Virtual DOM, diff 算法, 深度优先搜索, 同层比较, Keys, 更新策略, 优化策略
*[interview]: end
